# 1 概述
## 1.1 欺骗
### 1.1.1 ARP欺骗
一、子网内
拓扑结构
```c
            +--> [pc 1]
            |
[change] <--+--> [pc 2]
            |
            +--> [pc 3] 
```
背景：
1. pc 以太网网卡有4种接受模式：直接、多播、广播、混杂
2. ip与arp之间无直接映射关系

攻击场景：

### 1.1.2 IP欺骗

### 1.1.3 路由欺骗

### 1.1.4 TCP欺骗

# 2 信息收集
主机信息分类：
- 状态
- 操作系统
- 端口开放
- 软件版本
- 漏洞
  
## 2.1 状态
1. ICMP Echo攻击
- 向目标主机发送ICMP Echo Request包，等待ICMP Reply
- ICMP Sweep 并行探测
- Broadcast ICMP 广播域
2. Non-Echo ICMP
- 向目标主机发送其他类型 ICMP包
3. IP异常包头
- 向目标主机发送错误的IP包，判断目标主机返回信息：无效字段、错误分片、静止分片等
  
## 2.2 操作系统
1. 被动栈指纹识别：嗅探，判断IP TTL，TOS，DF和TCP Windows-size等
2. 主动栈指纹识别：TCP三次握手，ACK序号相等还是加一
3. TCP ISN取样：向目标主机多次握手，多次取样返回的ISN
4. ICMP包错误信息发送速率：向目标主机连续发送大量icmp错误包
5. ICP消息引用：向目标主机发送ICMP错误包，判断返回的错误引用长度

## 2.3 端口
1. TCP 连接（开放）：tcp三次握手，tcp反向idend（连接后请求返回进程pid和角色）
2. TCP SYN（半开放）：发送tcp syn包，关闭：返回rst，开启：返回syn+ack
3. TCP FIN（隐蔽）：发送fin包，关闭：返回rst，开启：无返回
4. TCP Xmax（隐蔽）：发送fin、urg、push标记的包，关闭：返回rst，开启：返回
5. TCP NULL （隐蔽）：发送关闭无标记包
6. FTP PROXY （隐藏）：请求ftp服务向目标主机建立连接
7. UDP：发送UDP包，关闭：ICMP port unreachable，开启：无返回

# 3 拒绝服务攻击

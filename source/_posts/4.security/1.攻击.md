---
title: 网络安全 socket编程
date: 2023-01-01 16:03:37
categories:
    - 网络安全
tags:
    - 网络安全
---


# 1 概述
## 1.1 欺骗
### 1.1.1 ARP欺骗
- 概述：局域网内，结合数据传播特点，伪造数据，欺骗机器网卡
- 模型：
    - 主机：维护ARP缓存，内容为 [IP:MAC]
    - 协议：ARP：Address Resolution Protol：根据IP获取MAC
    - 主机网卡：
        - 网卡工作模式：
            - 混杂：接收所有数据
            - 广播：接收dest_addr为广播地址的数据
            - 多播：接收dest_addr为多播地址的数据
            - 单播：接收dest_addr为本机地址的数据
            - 链路层：需要MAC地址
    - 交换机
        - 分类：二层、三层、四层交换机
        - 二层交换机：根据MAC，找到端口，发送数据，维护MAC缓存，内容为 [MAC:端口]
    - 示意图
        ```bash
                    帧[mac][ip]           帧[mac][ip]
            [主机1] -----------> [交换机] -------------> [主机2]
        | IP | MAC |          | 端口 | MAC |
        | IP | MAC |          | 端口 | MAC |
        ```
- 攻击方式：
    - 1 攻击机：发送大量 虚假MAC 的帧，占满交换机缓存，让交换机广播数据
    - 2 攻击机：发送虚假的ARP：欺骗局域网内的主机
    - 3 受害机：把数据发到错误的地方，比如攻击机
- 解决：
    - 预防：主机静态ARP表、进制ARP
    - 检测：看某台主机的ARP缓存，判断是否有主机发送大量ARP包
    - 检测：看无通信主机的ARP缓存，检测是否缓存了ARP包

### 1.1.2 IP欺骗

### 1.1.3 路由欺骗

### 1.1.4 TCP欺骗

# 2 信息收集
主机信息分类：
- 状态
- 操作系统
- 端口开放
- 软件版本
- 漏洞
  
## 2.1 状态
1. ICMP Echo攻击
- 向目标主机发送ICMP Echo Request包，等待ICMP Reply
- ICMP Sweep 并行探测
- Broadcast ICMP 广播域
2. Non-Echo ICMP
- 向目标主机发送其他类型 ICMP包
3. IP异常包头
- 向目标主机发送错误的IP包，判断目标主机返回信息：无效字段、错误分片、静止分片等
  
## 2.2 操作系统
1. 被动栈指纹识别：嗅探，判断IP TTL，TOS，DF和TCP Windows-size等
2. 主动栈指纹识别：TCP三次握手，ACK序号相等还是加一
3. TCP ISN取样：向目标主机多次握手，多次取样返回的ISN
4. ICMP包错误信息发送速率：向目标主机连续发送大量icmp错误包
5. ICP消息引用：向目标主机发送ICMP错误包，判断返回的错误引用长度

## 2.3 端口
1. TCP 连接（开放）：tcp三次握手，tcp反向idend（连接后请求返回进程pid和角色）
2. TCP SYN（半开放）：发送tcp syn包，关闭：返回rst，开启：返回syn+ack
3. TCP FIN（隐蔽）：发送fin包，关闭：返回rst，开启：无返回
4. TCP Xmax（隐蔽）：发送fin、urg、push标记的包，关闭：返回rst，开启：返回
5. TCP NULL （隐蔽）：发送关闭无标记包
6. FTP PROXY （隐藏）：请求ftp服务向目标主机建立连接
7. UDP：发送UDP包，关闭：ICMP port unreachable，开启：无返回

# 3 拒绝服务攻击

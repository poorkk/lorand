---
title: 安全 1 密码学
date: 2023-01-01 16:03:37
categories:
    - 安全
tags:
    - 安全
---

#### 对称密码（4 + 3） - ok
- 基本概念
  - 密钥扩展：1个密钥，扩展为多个的轮密钥。加密时，会迭代很多轮，每一轮都用1个轮密钥。

  - 7个常见算法：
    | 算法 | 密钥长度 | 分组长度 | 迭代轮数 | 轮函数 |
    |-|-|-|-|-|
    | DES | 64 | 64 | 16 | 置换：E扩展、异或、代换、P置换 |
    | 3DES | - | - | - | - |
    | IDEA | - | - | - | - |
    | AES | 128/192/256 | 128 | 10/12/14 | 构造矩阵：字节代换、行移位、列混合、异或 |
    | SM4 | 128 | 128 | 32 | 分组：异或、代换、移位 |
    | SM1 | 128 | 未公开 | - | - |
    | SM1 | 128 | 未公开 | - | - |

- 加密算法：只解决1个明文块加密
  - DES
    - 密钥：56 bit
      - 密钥扩展：16轮 * 48 bit密钥 （每轮生成1个轮密钥）
        1. 转换：64 -> 56 bit，忽略校验位
        2. 移位
        3. 合并：28 bit 与 28 bit合并
        3. 代换：
    - 明文：64 bit
    - 加密：16轮
      1. 置换：前面的bit后后面的bit置换
      2. 异或
      3. 代换
    - 解密

  - 3DES：3 * 16 轮
  - IDEA：欧洲标准

  - AES
    - 密钥：128 / 192 / 256 bit
      - 密钥扩展：10 / 12 / 14 轮 * 32 bit 密钥（每轮生成1个轮密钥）
        1. 移位：左移
        2. 代换：S盒代换
        3. 异或：与固定基数异或
    - 明文：128 bit
    - 加密：10 / 12 / 14 轮 （与密钥长度有关） 构造1个矩阵：4 x 4 字节 = 4 * 4 * 8 bit = 128 bit
      1. 代换：字节代换
      2. 移位：行移位
      3. 混合：列混合 （各分组拼成矩阵，矩阵相乘）
      4. 异或：轮密钥加
    - 解密：轮密钥加、逆列混合、逆行移位、逆字节代换

  - SM4
    - 密钥：128 bit
      - 密钥扩展：32轮 * 32 bit 密钥 （每轮生成1个轮密钥）
        1. 分组：分为4组 * 32bit
        2. 异或：与固定基数异或
        3. 代换：S盒代换
        4. 移位：移位并与其他分组异或
    - 明文：128 bit，分为4组 * 32bit
    - 加密：32轮 -> 分为4组 * 32bit
      1. 异或：轮密钥异或
      2. 代换：S盒代换
      3. 移位：行移位并与自己异或
    - 解密：
  - SM1：密钥长度128 bit，未公开算法
  - SM7：密钥长度128 bit，未公开算法

- 加密模式：解决多个明文块加密

  | 模式  | 中文 | 描述 |
  | - | - | - |
  | ECB | 电子密码本 | 不同的明文块，用相同的密钥 |
  | CBC | 密码分组链接 | 上1密文块，与下一明文块异或 | 
  | CTR | 计数器模式 | 密钥加密计数器生成密钥流，密文块与密钥流异或 |
  | CFB | 密码反馈模式 | - 
  | OFB | 输出反馈模式 | 与CFB类似

#### 非对称密码 - ok
- 基本概念
  - 原理：基于数学问题的难解性，给定输入，计算输出容易；给定输出，计算输入困难。
  - 4个常见算法

  | 算法 | 安全密钥长度 | 数论基础 | 安全性基础 | 
  | - | - | - | - |
  | RSA | 2048 bit | 欧拉定理 | 整数分解问题的难解性 |
  | ElGamal | 1024 bit | 离散对数 | 有限域上，离散对数问题的难解性 |
  | ECC | 160 bit | 离散对数 | 椭圆曲线上，离散对数问题的难解性 |
  | SM2 | 256 bit | 离散对数 | 椭圆曲线上，离散对数问题的难解性 |
- 加密算法：
  - RSA
  - ElGamal
  - ECC
  - SM2

#### 哈希算法 - ok
- 基本概念：
  - 原理：相同的输入，获得相同的输出
  - 3个常见算法：

  | 算法 | 输出长度 |
  | - | - |
  | MD5 | 128 bit |
  | SHA1 | 160 bit |
  | SHA256 | 256 bit |
  | SM3 | 256 bit |

- MAC

  | 认证模式 | 算法 | 密钥长度 |
  | - | - | - | - |
  | HMAC | HMAC-MD5 | 128 bit | 
  | HMAC | HMAC-SHA1 | 160 |
  | HMAC | HMAC-SHA256 | 256 |
  | HMAC | SM3 | 256 | 
  | DES | CBC-MAC | 64 |
  | AES | CBC-MAC | 128 |

#### 密钥管理

#### PKI
